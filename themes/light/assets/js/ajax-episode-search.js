function enableLink(e){e.on("click.disabled",!1),e.prop("enableClick","1"),e.fadeTo("fast",1)}function disableLink(e){e.off("click.disabled"),e.prop("enableClick","0"),e.fadeTo("fast",.5)}function updateImages(e){$.each(e.episodes,((e,s)=>{let a="";const i=$("a[id="+s.show.indexer+"x"+s.show.series_id+"x"+s.episode.season+"x"+s.episode.episode+"]"),o=i.children("img[data-ep-search]"),t=i.parent();if(i){if("searching"===s.search.status.toLowerCase())o.prop("title","Searching"),o.prop("alt","Searching"),o.prop("src","images/loading16.gif"),disableLink(i),a=s.search.status;else if("queued"===s.search.status.toLowerCase())o.prop("title","Queued"),o.prop("alt","queued"),o.prop("src","images/queued.png"),disableLink(i),a=s.search.status;else if("finished"===s.search.status.toLowerCase()){o.prop("title","Searching"),o.prop("alt","searching"),o.parent().prop("class","epRetry"),o.prop("src","images/search16.png"),enableLink(i);let e="";if("na"!==s.episode.quality_style){e=" <span "+window.Vue.options.components["quality-pill"].options._scopeId+' class="quality '+s.episode.quality_style+'">'+s.episode.quality_name+"</span>"}a=s.episode.status+e,t.closest("tr").prop("class",s.episode.overview+" season-"+s.episode.season+" seasonstyle")}t.siblings(".col-status").html(a)}const r=$("a[id=forceUpdate-"+s.show.indexer+"x"+s.show.series_id+"x"+s.episode.season+"x"+s.episode.episode+"]"),n=r.children("img");r&&("searching"===s.search.status.toLowerCase()?(n.prop("title","Searching"),n.prop("alt","Searching"),n.prop("src","images/loading16.gif"),disableLink(r)):"queued"===s.search.status.toLowerCase()?(n.prop("title","Queued"),n.prop("alt","queued"),n.prop("src","images/queued.png")):"finished"===s.search.status.toLowerCase()&&(n.prop("title","Forced Search"),n.prop("alt","[search]"),n.prop("src","images/search16.png"),"snatched"===s.episode.overview.toLowerCase()?r.closest("tr").remove():enableLink(r)))}))}function checkManualSearches(){let e=5e3;const s="home/getManualSearchStatus",a=$("#indexer-name").val(),i=$("#series-id").val(),o=void 0===i?s:s+"?indexername="+a+"&seriesid="+i;$.ajax({url:o,error(){e=3e4},type:"GET",dataType:"JSON",complete(){setTimeout(checkManualSearches,e)},timeout:15e3}).done((s=>{e=s.episodes?5e3:15e3,updateImages(s)}))}PNotify.prototype.options.maxonscreen=5,$.fn.forcedSearches=[],$(document).ready((()=>{checkManualSearches()})),$.ajaxEpSearch=function(e){e=$.extend({},{size:16,colorRow:!1,loadingImage:"loading16.gif",queuedImage:"queued.png",noImage:"no16.png",yesImage:"yes16.png"},e),$(".epRetry").on("click",(function(e){if(e.preventDefault(),"0"===$(this).prop("enableClick"))return!1;$.selectedEpisode=$(this),$("#forcedSearchModalFailed").modal("show")})),$(".epSearch").on("click",(function(s){if(s.preventDefault(),"0"===$(this).prop("enableClick"))return!1;$.selectedEpisode=$(this),$(this).parent().parent().children(".col-status").children(".quality").length>0?$("#forcedSearchModalQuality").modal("show"):function(){let s,a;const i=$.selectedEpisode.parent(),o=$.selectedEpisode,t=$.selectedEpisode.children("img");t.prop("title","loading"),t.prop("alt",""),t.prop("src","images/"+e.loadingImage);let r=$.selectedEpisode.prop("href");r=r.replace("retryEpisode","searchEpisode"),$.getJSON(r,(r=>{"failure"===r.result.toLowerCase()?(s=e.noImage,a="failed"):(s=e.loadingImage,a="success",e.colorRow&&i.parent().removeClass("skipped wanted qual good unaired").addClass("snatched"),disableLink(o)),t.prop("title",a),t.prop("alt",a),t.prop("height",e.size),t.prop("src","images/"+s)}))}()})),$(".epManualSearch").on("click",(function(e){if(e.preventDefault(),$(this).hasClass("disabled"))return!1;$(".epManualSearch").addClass("disabled"),$(".epManualSearch").fadeTo(1,.1);const s=this.href;e.shiftKey||e.ctrlKey||2===e.which?window.open(s,"_blank"):window.location=s}))};